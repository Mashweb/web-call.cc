<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="description" content="2 example sequentially programmed web applications">
    <meta name="keywords" content="Zen, sequential programming, web applications, web apps, demos, examples, Zen, code">
    <meta name="author" content="Tom Elam">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-173606225-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-173606225-1');
    </script>
    <title>web-call.cc | Demo #2: Sequential programming</title>

    <!-- <link href="website/css/screen.css" rel="stylesheet" type="text/css"> -->
    <link href="website/css/jquery.terminal-2.3.0.css" rel="stylesheet" type="text/css">
    <link href="website/css/prism-coy.css" rel="stylesheet" type="text/css">
    <link href="gui.css" rel="stylesheet" type="text/css">

    <script>
      var biwa;
      window.onload = function() {
          var onError = function(e){ console.error(e); }
          biwa = new BiwaScheme.Interpreter(onError);
          biwa.evaluate('(load "in-browser-gui.scm")',
                        function(result) { console.log('Scheme loaded.'); });
      };
    </script>
    <script>
      var body;
      var cldn;
      window.addEventListener('DOMContentLoaded', () => {
	body = document.body;
	cldn = body.children;
	console.log("(In JS) body => " + body);
      });
    </script>
  </head>
  <body>
    <!-- Apply typography and color theme modules globally from `vaadin-lumo-styles` -->
    <custom-style>
      <style include="lumo-typography lumo-color"></style>
    </custom-style>
    
    <vaadin-app-layout style="overflow: auto;">

      <vaadin-drawer-toggle slot="navbar"></vaadin-drawer-toggle>

      <img slot="navbar" src="images/zen.png" alt="Zen Logo" width="32" height="32" referrerpolicy="no-referrer">
      <h2 slot="navbar" class="zen-navbar-heading">&nbsp;&nbsp;web-call.cc | Demos of Zen technology prototypes</h2>

      <vaadin-tabs selected="2" slot="drawer" orientation="vertical" theme="minimal" style="margin: 0 auto; flex: 1;">
        <vaadin-tab>
          <iron-icon icon="vaadin:home"></iron-icon>
          <a href="index.html">The Zen web app framework</a>
        </vaadin-tab>
        <vaadin-tab>
          <iron-icon icon="vaadin:list"></iron-icon>
          <a href="live-dom-editor.html">Demo #1: Live DOM editor</a>
        </vaadin-tab>
        <vaadin-tab>
          <iron-icon icon="vaadin:list" selected></iron-icon>
          <a href="sequentially-programmed-web-apps.html">Demo #2: Introduction to Zen sequential web app programming</a>
        </vaadin-tab>
        <vaadin-tab>
          <iron-icon icon="vaadin:list"></iron-icon>
          <a href="visual-programming.html">Demo #3: Visual program editor</a>
        </vaadin-tab>
        <vaadin-tab>
          <iron-icon icon="vaadin:list"></iron-icon>
          <a href="other-experiments.html">Other experimental code</a>
        </vaadin-tab>
      </vaadin-tabs>
      
      <h1 style="margin:0.2em 0em 0em 0em;">Demo #2: Introduction to Zen sequential web app programming</h1>

      <div class="content" style="max-width:560px; overflow: auto;">

        <vaadin-details id="bsconsole">
          <div slot="summary"><span id="constate"></span></div>
	  Refer to <a href="https://www.biwascheme.org/">Biwascheme.org</a> to learn more about Biwascheme.
	  <div id="term"></div>
        </vaadin-details>

        <vaadin-details id="simple_example">
          <div slot="summary"><span id="simple_example_state"></span></div>
	  To run the application, type the following command into the BiwaScheme console above, terminated
	  by a RETURN:
	  <p><code>(load "simple_seq_webapp.scm")</code></p>
	  The program will terminate after receiving five events from any combination of:
	  a click on Dev #1, a click on Div #2, a click on Button #1 followed by a key press,
	  a click on Button #2 followed by a key press, or a 10-second timeout.
	  <div id="testarea" style="border:solid; background-color:lightgrey; padding:20px; margin: 21px 15px 15px 15px; height:100px; width:425px;">
	    Test Area<br/>
	    <button id="button1" style="height:60px; width:100px;">Button #1</button>
	    <button id="button2" style="height:60px; width:100px;">Button #2</button>
	    <div id="div1" style="float:left; height:30px; width:80px; background-color:yellow; padding:15px;">
	      Div #1
	    </div>
	    <div id="div2" style="float:left; height:30px; width:80px; background-color:pink; padding:15px;">
	      Div #2
	    </div>
	  </div>
	  Here is the main part of the app:<code>
	    <pre>
(with-handlers ((click-handler "#div1")
                (click-handler "#div2")
                (keydown-handler "#button1")
                (keydown-handler "#button2")
                (timeout-handler test-timeout 10000))
  (display (get-input))
  (display (get-input))
  (display (get-input))
  (display (get-input))
  (display (get-input)))
(display "Test finished.")</pre>
	  </code>
	  The full app is
	  <a href="https://raw.githubusercontent.com/Mashweb/web-call.cc/master/simple_seq_webapp.scm">here</a>.
        </vaadin-details>

        <vaadin-details id="calculator_example">
          <div slot="summary"><span id="calculator_example_state"></span></div>
	  To run the calculator application, type the following command into the BiwaScheme console above, terminated
	  by a RETURN:
	  <p><code>(load "calculator.scm")</code></p>
	  <p>Then click the calculator's purple keys in the test area and watch the results in the Biwascheme console.
	  The calculator does addition, subtraction, multiplication, and division.<p>
	  <div id="testarea2" style="border:solid; background-color:lightgrey; padding:20px; margin: 21px 15px 15px 15px; height:auto; min-height:100px; width:200px;">
	    Test Area<br/>
	  </div>
	  <p>Here is the main part of the app:</p><code>
	    <pre>
(with-handlers ((click-handler ".button"))
  (let* ((btn (js-ref (second (get-input)) "target"))
         (text (js-ref btn "innerText")))
    (case text
      (("+" "-" "*" "/")
       (when (not (= value2 0))
         (set! value1 value2))
       (set! value2 0)
       (set! op (string->symbol text)))
      (("=")
       (when op
         (set! value1 ((eval op) value1 value2))
         (set! value2 0)))
      (else
       (set! value2 (+ (* value2 10) (string->number text)))))
    (if op
        (format #t "~a ~a ~a~%" value1 (symbol->string op) value2)
        (format #t "~a~%" value2))))</pre>
	  </code>
	  The full app is at
	  <a href="https://raw.githubusercontent.com/Mashweb/web-call.cc/master/calculator.scm">calculator.scm</a>
	  

	  The calculator program is slow to load but practically self explanatory.
        </vaadin-details>
	
      </div> <!-- class="content" -->

      <p>Read the page <a href="https://doc.mashweb.club/experiments/seq_webapp_biwascheme/">"Sequentially
	Programmed Web App Demo"</a> for more background on sequentially programmed applications.</p>
      <vaadin-button class="nextbutton" onclick="location.href='visual-programming.html'">Next</vaadin-button>
    </vaadin-app-layout>

    <!-- Biwascheme console code -->
    <script src="js/biwascheme-0.6.9-min.js"></script>
    <script src="website/js/jquery.mousewheel.min.js"></script>
    <script src="website/js/jquery.timers.min.js"></script>
    <script src="website/js/jquery.cookie.min.js"></script>
    <script src="website/js/jquery.terminal-2.3.0.js"></script>
    <script src="website/js/prism.js"></script>
    <script src="website/js/prism-scheme.js"></script>
    <script src="website/js/jquery.terminal.prism.js"></script>
    <script src="website/js/keyboard.js"></script>
    <script src="website/js/biwascheme_terminal.js"></script>
    <!-- End of Biwascheme console code -->
    <script src="bundle.js"></script>
    <script src="js/widgets-control.js"></script>
  </body>
</html>
