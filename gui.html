<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>web-call.cc</title>
    <style>
      h2 { padding: 0.2em; margin-bottom: 1em; border-bottom: 1px solid black; }
      div#canvas { padding: 10px; border: 1em solid white; background-color: #a5a096; }
      div#menu { padding-left: 40px; }
      div.prominent { margin:15px; min-height:50px; padding:10px; border:2px solid blue; }
      ul { margin: 0; padding: 10px 10px 5px 24px; }
      p  { margin-top: 1em; margin-bottom: 0; }
      button { width: 8em; }
      button.ghosted { background-color:#a0a0a0; }
    </style>
    <script src="js/optimal-select.js"></script>
    <script>
      window.addEventListener('DOMContentLoaded', () => {
        var treeWalker;
	treeWalker = document.createTreeWalker(document.body, NodeFilter.SHOW_ELEMENT, {
	    acceptNode: function (node) {
		return NodeFilter.FILTER_ACCEPT;
	    }
	}, false);
	//console.log("TreeWalker");
	do {
	    //console.log(treeWalker.currentNode);
	    // Text selections, images, and links have an OS-dependent default rendering
	    // of them being dragged. If we want that default behavior, we should not
	    // set the "draggable" attribute of them.
            treeWalker.currentNode.draggable = "true";
	} while (treeWalker.nextNode());
      });
    </script>
  </head>
  <body>
    <h2>web-call.cc</h2>
    <div id="canvas">
      <h3>DOM editor tools:</h3>
      <div id="tools">
	<button id="add" class="ghosted">Add-append</button>
	<button id="copy" style="background-color:lightgreen">Copy</button>
	<button id="paste" class="ghosted">Paste-append</button>
	<button id="move" style="background-color:lightgreen">Move</button>
	<button id="delete" class="ghosted">Delete</button>
	<button id="undo" class="ghosted">Undo</button>
	<button id="redo" class="ghosted">Redo</button>
	<button id="save" class="ghosted">Save</button>
      </div>
      <div class="prominent">
	<p>This page demonstrates a prototype of the Zen DOM editor.
	  It will be improved as time permits.
	  The interesting aspect of it is not the tools it provides the user,
	  but rather the very clear and simple programming of those tools.
	  It does not work in Explorer or mobile browsers.</p>
	<p>The program prompts you in red at the bottom of the page. Currently,
	  "Copy-append" and "Move-append" are the only tools that work.
	  Clicking on any other tool will produce the message
	  "Unimplemented operation."</p>
	  To start the demo, type the command
	  <pre><code>  (load "in-browser-gui.scm")</code></pre>
	  in the console at the bottom of the page, followed by RETURN or ENTER.
	  The command will attach BiwaScheme handlers
	  to drag and drop events. Then type the command
	  <pre><code>  (reset (test))</code></pre> in the console,
	  followed by RETURN or ENTER.
	  You will be instructed to choose a tool. Currently,
	  "Copy" and "Move" are the only tools that work.
	  Clicking on any other tool will produce the message
	  "Unimplemented operation."</p>
	<p>The BiwaScheme code can be
          downloaded at <a href="in-browser-gui.scm">in-browser-gui.scm</a>,
	  <a href="browser-util.scm">browser-util.scm</a>, and
	  <a href="mini-framework.scm">mini-framework.scm</a>.
	  Other experimental code can be found <a href="index2.html">here</a>.</p>
      </div>
      <div class="prominent">This is a DIV.</div>
      <div class="prominent">This is another DIV.</div>
      <div class="prominent">This is a third DIV.</div>
      <div class="prominent">This is a fourth DIV.</div>
    </div>
    <div>
    <div id="message"></div>
    <div id="error"></div>
    <script src="js/biwascheme-0.6.9-min.js" type="text/javascript"></script>
    <script type="text/javascript">
      var onError = function(e){ console.error(e); }
      var biwa = new BiwaScheme.Interpreter(onError);
      biwa.evaluate('(load "in-browser-gui.scm") (reset (test))'
		    , function(result) {
			alert(result);  //=> 3
		    });
    </script>
    </div>
  </body>
</html>
